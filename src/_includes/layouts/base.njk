{% set pageUrl = page
  .url
  .split('/')
  .slice(2)
  .join('/') %}

<!DOCTYPE html>
<html lang="{{ locale }}" dir="{{ dir }}">
  <head>
    <title>
      {% block title %}
        {{title}}
      {% endblock %}
    </title>
    <meta charset="UTF-8"/>
    {% if description %}
      <meta name="description" content="{{description}}"/>
    {% endif %}
    <meta http-equiv="x-ua-compatible" content="ie=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover"/>
    {% if tags %}
      <meta name="keywords" content="{{tags}}"/>
    {% else %}
      <meta name="keywords" content="web development, rails, ruby on rails, blog, web design"/>
    {% endif %}
    <link rel="stylesheet" href="/assets/styles/tailwind.css?v={% version %}"/>
    <link rel="canonical" href="{{site.url}}/{{locale}}/{{pageUrl}}">
    <meta property="og:locale" content="{{locale}}">
    <meta property="og:title" content="{{title}}">
    <meta property="og:description" content="{{description}}">
    <meta property="og:url" content="{{site.url}}{{page.url}}">
    <meta property="og:site_name" content="Felipe Moyano">
    {% if not featured_image %}
      <meta property="og:image" content="{{site.url}}{{site.defaultSocialImage}}">
      <meta property="og:image:width" content="1200">
      <meta property="og:image:height" content="630">
      <meta property="og:image:alt" content="{{site.title}}">
      <meta name="twitter:image" content="{{site.url}}{{site.defaultSocialImage}}">
    {% endif %}
    <meta name="generator" content="{{ eleventy.generator }}">
    {% block head %}
      {{ head }}
    {% endblock %}

    {% for locale in locales -%}
      <link rel="alternate" href="{{site.url}}/{{locale.code}}/{{pageUrl}}" hreflang="{{ locale.code }}">
    {% endfor -%}

    <link rel="alternate" type="application/atom+xml" title="{{ site.title }} - English Blog Feed" href="{{ site.url }}/en/feed.xml" hreflang="en">
    <link rel="alternate" type="application/atom+xml" title="{{ site.title }} - Feed en EspaÃ±ol" href="{{ site.url }}/es/feed.xml" hreflang="es">

    <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.7.0/dist/alpine.min.js" defer="defer"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="/assets/img/transition_400x.png">
    <link href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css" rel="stylesheet">

    {% if site.environment === "production" %}
      <!-- Global site tag (gtag.js) - Google Analytics -->
      <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-8THYF9RS37"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() {
          dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'G-8THYF9RS37');
      </script>
      <script async="async" defer="defer" data-domain="gafemoyano.com" src="https://plausible.io/js/plausible.js"></script>
    {% endif %}
  </head>
  <body class="flex flex-col min-h-screen overflow-x-hidden antialiased text-gray-800 bg-gray-50 font-body text-base">
    {% include "navbar.njk" %}

    {% block content %}
      {{ content | safe }}
    {% endblock %}

    <div class="mt-20">
      {% include "footer.njk" %}
    </div>
  </body>
</html>
